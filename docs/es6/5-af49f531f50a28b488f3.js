webpackJsonp([5], function(__wpcc){'use strict';var oc=function(a,b,c){b in a?Object.defineProperty(a,b,{value:c,enumerable:!0,configurable:!0,writable:!0}):a[b]=c;return a},X=function(a,b,c){b in a?Object.defineProperty(a,b,{value:c,enumerable:!0,configurable:!0,writable:!0}):a[b]=c;return a};
var pc=class extends __wpcc.C{constructor(...a){super(...a);oc(this,"tFix",a=>{a=""+a;return(1===a.length?"0":"")+a});oc(this,"__startTicks",()=>this.parseTime())}parseTime(){var a=this.props;const b=+new Date;a=a.timeLeft-(b-a.prevTime)/1E3;const c=Math.floor(a/3600);var d=a%3600;const f=Math.floor(d/60);d=Math.round(d%60);this.props.setTimeLeft(a,b);this.setState({hours:c,mins:f,sec:d})}componentDidUpdate(){const {hours:a,mins:b,sec:c}=this.state;if(0===a&&0===b&&0===c||[a,b,c].some(a=>0>a))return clearInterval(this.___interval),
this.props.timeOver()}componentDidMount(){this.___interval=setInterval(this.__startTicks,1E3)}componentWillUnmount(){clearInterval(this.___interval)}render(a,b){a=this.tFix;if(!("hours"in b&&"mins"in b&&"sec"in b))return"";const {hours:c,mins:d,sec:f}=b;return[c,d,f].some(a=>0>a)?"":`${a(c)}:${a(d)}:${a(f)}`}};const qc=__wpcc.P.getStore(),Y=__wpcc.P.getStrings();
var rc=class extends __wpcc.C{constructor(...a){super(...a);X(this,"state",{isFetching:!1,questions:null,answers:null,timeOver:!1});X(this,"timeOver",()=>{this.setState({timeOver:!0,forceSubmit:!0,answers:this.state.answers.slice().map(a=>null==a?-1:a)})});X(this,"timeLeft",(a,c)=>this.setState({timeLeft:a,prevTime:c}));X(this,"_submit",()=>{if(!this.state.results&&!this.state.awaitingScore){var a=this.state.answers,c=qc.userData.scholar,d=this.state.questions.subject;if(!this.state.forceSubmit){const b=
[];a.forEach((a,c)=>null==a&&b.push(c+1));if(b.length)return this.setState({$AnswerError:b.join(", ")})}this.setState({awaitingScore:!0});__wpcc.I(__wpcc.S.gradeTest,{scholar:c,subject:d,answers:a}).then(a=>{if(a.error)return this.setState({error:a.error,awaitingScore:!1,timeOver:!1});__wpcc.P.set("userData",a.user_data);this.setState({results:a,awaitingScore:!1,timeOver:!1})})}});X(this,"_answerQuestion",a=>{var b=a.target.dataset;a=+b.question_index;b=+b.option_index;this.state.answers[a]===b&&
(b=null);const d=this.state.answers.slice();d[a]=b;__wpcc.I(__wpcc.S.quickSave,{subject:this.state.questions.subject,answers:d});this.setState({answers:d})});X(this,"_closePopup",()=>this.setState({timeOver:!1}));X(this,"_clearError",()=>this.setState({$AnswerError:null}));X(this,"__closeTest",()=>__wpcc.E("/profile"))}componentDidUpdate(){!this.state.timeOver||this.state.awaitingScore||this.state.results||this._submit()}componentDidMount(){if(!qc.isLoggedIn)return __wpcc.E("/");const a=__wpcc.G.getCurrentParams("/exam/:sub").sub.trim();
if(!a)return this.setState({error:Y.Exam$Invalid});this.setState({isFetching:!0});__wpcc.I(__wpcc.S.startTest,{scholar:qc.userData.scholar,subject:a.trim()}).then(a=>{if(a.error)return this.setState({error:a.error,isFetching:!1});let b=a.previous_answers||[],d;b.length&&b.some(a=>null!=a)&&(d=b);this.setState({questions:a,isFetching:!1,prevTime:+new Date,answers:d||Array(a.question_data.length).fill(null),timeLeft:a.time_allotted-(a.now-a.start_time)})})}render(a,b){return b.error?__wpcc.v(__wpcc.kb,
{reasons:[b.error],close:this.__closeTest}):b.$AnswerError?__wpcc.v(__wpcc.L,{close:this._clearError,title:Y.Exam$UnansweredQuestionsLeft,errorHead:Y.Exam$NoNegativeMarking,reasons:[b.$AnswerError]}):b.isFetching?__wpcc.v("div",{style:__wpcc.F},Y.Exam$LoadingQuestions):b.timeOver?__wpcc.v(__wpcc.L,{close:this._closePopup,title:Y.Exam$TimeUp,errorHead:Y.Exam$TimeUpAnswerSubmitInfo}):b.awaitingScore?__wpcc.v("div",{style:__wpcc.F},Y.Exam$CalculatingScore):b.results?__wpcc.v(__wpcc.L,{close:this.__closeTest,
title:Y.Exam$ResultText,errorHead:__wpcc.v(__wpcc.w,null,__wpcc.v("div",null,Y.Exam$MaximumMarks+b.results.total),__wpcc.v("div",null,Y.Exam$YourScore)),reasons:[b.results.score]}):b.questions&&__wpcc.v("div",null,__wpcc.v("div",{class:"exam-header"},"class ",b.questions.grade," - ",b.questions.subject," test"),__wpcc.v("div",{class:"total-time"},Y.Exam$TimeAllotted,__wpcc.v("span",{class:"bold"},__wpcc.$b(b.questions.time_allotted))),__wpcc.v("span",{class:"t-left"},Y.Exam$TimeLeft,__wpcc.v(pc,{timeOver:this.timeOver,
setTimeLeft:this.timeLeft,timeLeft:b.timeLeft,prevTime:b.prevTime})),__wpcc.v("div",{class:"questions-container"},b.questions.question_data.map((a,d)=>__wpcc.v(__wpcc.rb,{x:a,i:d,setOption:b.timeOver?null:this._answerQuestion,answered:b.answers[d]}))),__wpcc.v("button",{class:"submit-exam hoverable",onClick:this._submit},Y.Exam$Submit))}};__wpcc.Ub={};__wpcc.Ub.default=rc;});
