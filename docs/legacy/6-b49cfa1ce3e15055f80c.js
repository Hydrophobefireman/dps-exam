webpackJsonp([6], function(__wpcc){'use strict';var Hc=function(a){return a},Jc=function(a){return Ic(function(){return Ic(a)})},Kc=function(a,b){return new Promise(function(c){function d(){clearTimeout(e);c()}a.addEventListener(b,d,{once:!0});a.addEventListener("error",d,{once:!0});var e=setTimeout(d,e||5E3)})},Z=function(a,b){this.options=b||{drawImgTagsOnCanvas:!1,timeout:5E3};this._svg=this._height=this._width=this._imgReadyForCanvas=this._img=null;this._canvas=document.createElement("canvas");this._canvasContext=this._canvas.getContext("2d");
this._clonedChildren=this._sourceChildren=this._clonedNode=this._sourceNode=this._canvasState=null;a&&this.from(a);this._xmlSerializer=new XMLSerializer},Lc=function(a,b,c){b in a?Object.defineProperty(a,b,{value:c,enumerable:!0,configurable:!0,writable:!0}):a[b]=c;return a},Nc=function(){var a,b;return __wpcc.p.asyncExecutePromiseGeneratorProgram(function(c){if(1==c.nextAddress)return(a=__wpcc.E.getCurrentParams("/report/:sub").sub.trim())?c.yield(__wpcc.I(__wpcc.cc.getReport,{subject:a}),2):c.return(function(){return"Invalid Subject"});
b=c.yieldResult;return b.error?c.return(function(){return __wpcc.v(__wpcc.qb,{errorHead:b.error,close:function(){return __wpcc.C("/profile")}})}):c.return(function(){return __wpcc.v(Mc,{data:b})})})},Mc=function(a){a=a.data;return __wpcc.v("div",null,__wpcc.v("div",{class:"report-component"},Oc.Report$YourReportFor(a.subject)),__wpcc.v("div",null,Oc.Exam$YourScore," - ",a.score),__wpcc.v("div",null,Oc.Report$CorrectAnswers),__wpcc.v(Pc),__wpcc.v("div",{id:"answer-map",style:{backgroundColor:"var(--background-color)"}},
a.question_data.map(function(a,c){return __wpcc.v(__wpcc.yb,{x:a,i:c})})))},Pc=function(a){for(var b=[],c=0;c<arguments.length;++c)b[c-0]=arguments[c];__wpcc.y.apply(this,[].concat(__wpcc.p.arrayFromIterable(b)));var d=this;Lc(this,"state",{currentAction:"Download Report"});Lc(this,"_download",function(){var a,b,c;return __wpcc.p.asyncExecutePromiseGeneratorProgram(function(e){if(1==e.nextAddress)return d.setState({currentAction:"Serializing Page Contents..."}),a=new Z(document.getElementById("answer-map")),
e.yield(a.screenshot(),2);if(3!=e.nextAddress)return d.setState({currentAction:"Generating JPG.."}),e.yield(a.toDataUri("image/jpeg"),3);b=e.yieldResult;c=document.createElement("a");Object.assign(c,{download:"report-"+ +new Date,href:b}).click();d.setState({currentAction:"Download Report"});e.jumpToEnd()})})},Qc=Array.from||function(a){return[].slice.call(a)},Rc=window.unescape||Hc,Sc=Promise.prototype.then.bind(Promise.resolve()),Ic=window.requestAnimationFrame||Sc||queueMicrotask;
Z.cloneStyle=function(a,b){a=getComputedStyle(a);for(var c=[],d=__wpcc.p.makeIterator(a),e=d.next();!e.done;e=d.next()){e=e.value;var h=a.getPropertyValue(e);h&&c.push(e+":"+h+";")}b.style.cssText=c.join("")};
Z.inlineImageIfPossible=function(a,b){if(0!==["blob","data"].indexOf(a.src.substr(0,4))){var c=Kc(a,"load",b).then(function(){var c=document.createElement("canvas");c.height=a.height;c.width=a.width;var e=c.getContext("2d");e.drawImage(a,0,0);try{var h=!e.getImageData(0,0,1,1)}catch(k){h=!0}if(!h)return e=Kc(a,"load",b),a.src=c.toDataURL(),e});a.crossOrigin="anonymous";return c}};Z.prototype._clone=function(a){return a.cloneNode(!0)};
Z.prototype.from=function(a){this._width=this._height=0;this._canvasState=Z.DRAW_PENDING;this._sourceNode=a;this._clonedNode=this._clone(this._sourceNode);this._sourceChildren=Qc(this._sourceNode.querySelectorAll("*"));this._clonedChildren=Qc(this._clonedNode.querySelectorAll("*"));return this};Z.prototype._cloneChildNodeStyle=function(){for(var a=this._clonedChildren,b=this._sourceChildren,c=0;c<a.length;c++)Z.cloneStyle(b[c],a[c])};
Z.prototype._walkChildNodes=function(){for(var a=[],b=__wpcc.p.makeIterator(this._clonedChildren),c=b.next();!c.done;c=b.next()){c=c.value;var d=c.tagName;"SCRIPT"===d||"STYLE"===d||"HEAD"===d||"NOSCRIPT"===d||"none"===c.style.display?c.remove():this.options.drawImgTagsOnCanvas&&"IMG"===d&&a.push(Z.inlineImageIfPossible(c,this.options.timeout))}return a};
Z.prototype._cleanMargin=function(){var a=this;["margin","marginLeft","marginTop","marginBottom","marginRight"].forEach(function(b){return a._clonedNode.style[b]=""})};
Z.prototype._generateSVG=function(){var a=this._sourceNode,b=this._clonedNode,c=a.scrollWidth;a=a.scrollHeight;b.setAttribute("xmlns","http://www.w3.org/1999/xhtml");b=this._xmlSerializer.serializeToString(b);this._svg="<?xml version='1.0' encoding='UTF-8' ?><svg\n    xmlns=\"http://www.w3.org/2000/svg\"\n      width=\""+c+'"\n      height="'+a+'">\n      <foreignObject width="100%" height="100%" x="0" y="0">'+b+"</foreignObject>\n    </svg>\n   ";this._img=new Image(c,a);this._imgReadyForCanvas=
Kc(this._img,"load",this.options.timeout);this._img.crossOrigin="anonymous";this._img.src="data:image/svg+xml;charset=utf-8;base64,"+btoa(Rc(encodeURIComponent(this._svg)));this._width=c;this._height=a};Z.prototype._generateCanvas=function(){if(this._canvasState!==Z.DRAWN){var a=document.createElement("canvas"),b=a.getContext("2d");a.height=this._height;a.width=this._width;this._canvas=a;this._canvasContext=b}};
Z.prototype._fillCanvas=function(){this._canvasState!==Z.DRAWN&&(this._canvasContext.drawImage(this._img,0,0),this._canvasState=Z.DRAWN,this._clonedNode=this._sourceNode=this._clonedChildren=this._sourceChildren=this._imgReadyForCanvas=null)};
Z.prototype.screenshot=function(){var a=this;return new Promise(function(b){return Jc(function(){if(!a._clonedNode)throw Error("No source node has been specified");a._cloneChildNodeStyle();var c=a._walkChildNodes();return Promise.all(c).then(function(){Z.cloneStyle(a._sourceNode,a._clonedNode);a._cleanMargin();a._generateSVG();return a._imgReadyForCanvas.then(function(){a._imgReadyForCanvas=null;a._generateCanvas();a._fillCanvas();b(a)})}).catch(function(c){console.log(c);b(a)})})})};
Z.prototype.drawImage=function(){var a=this;return new Promise(function(b){return Jc(function(){a._fillCanvas();return b(a)})})};Z.prototype.toDataUri=function(a,b){var c=this;return new Promise(function(d){return c.drawImage().then(function(){return Jc(function(){return d(c._canvas.toDataURL(a||"image/jpeg",b||1))})})})};
Z.prototype.toBlob=function(a,b){var c=this;return new Promise(function(d){return c.drawImage().then(function(){return Jc(function(){return c._canvas.toBlob(d,a||"image/jpeg",b||1)})})})};Z.DRAW_PENDING=0;Z.DRAWN=1;var Oc=__wpcc.O.getStrings();__wpcc.p.inherits(Pc,__wpcc.y);Pc.prototype.render=function(a,b){return __wpcc.v("button",{class:"dowload-report hoverable",onClick:this._download},b.currentAction)};__wpcc.bc={default:function(){return __wpcc.v(__wpcc.A,{componentPromise:Nc,fallbackComponent:function(){return Oc.Loading$Default}})}};});
